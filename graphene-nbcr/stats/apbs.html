<html>
  <head>
    <script type="text/javascript" src="http://canvg.googlecode.com/svn/trunk/rgbcolor.js"></script> 
    <script type="text/javascript" src="http://canvg.googlecode.com/svn/trunk/canvg.js"></script>
    <script type="text/javascript" src="https://www.google.com/jsapi"></script>
    <script type="text/javascript" src="base.js"> </script>

    <script type="text/javascript">
      // Define variables for the charts 

        // APBS registered users by year
        var data1 = new google.visualization.DataTable();
        data1.addColumn({ type: 'string', label: 'Labels' });
        data1.addColumn({ type: 'number', label: 'Count' });
        data1.addColumn({ type: 'number', label: '' });
        data1.addColumn({ type: 'string', role: 'annotation' });

        var options1 = {
            width: 400, 
            height: 360, 
            title: 'Registered users of APBS',
            colors: ['#3b96ce'],
            hAxis: {title: 'Year', textStyle: {color: 'black', fontSize: 11}},
            vAxis: {title: 'Count', textStyle: {color: 'black', fontSize: 11}},
            series: [{ type: 'bars',  visibleInLegend:false },
                    { type: 'line', color:'black', lineWidth: 0, visibleInLegend:false, pointSize: 0}]
        };

        // Website access world geographical distribution 
        var data2 = new google.visualization.DataTable();
        data2.addColumn('string', 'Country');
        data2.addColumn('number', 'Web service access ');

        var options2 = {
            resolution: "country",
            width: 400, 
            backgroundColor: "#FFFFFF",
            datalessRegionColor: "#EEE5E5",
            colorAxis: { colors : ['#b3e2f9','#0860b3' ], },
        };

      // Add data from stats
      function addData() {
        data1.addRows([
            ["2011", 15302, 15302, '15302'],
            ["2012", 17697, 17697, '17697'],
            ["2013", 19504, 19504, '19504'],
            ["2014", 21360, 21360, '21360'],
            ["2015", 21925, 21925, '21925'],
        ]);

        data2.addRows([
        ["Canada", 944], ["Saudi Arabia", 73], ["Lithuania", 65], ["Cambodia", 1], ["Ethiopia", 5],
        ["Aruba", 1], ["Palestine", 3], ["Belize", 1], ["Argentina", 163], ["Bolivia", 4],
        ["Cameroon", 5], ["Ghana", 3], ["Slovenia", 59], ["Guatemala", 2], ["Germany", 3323],
        ["Spain", 814], ["Liberia", 2], ["Netherlands", 314], ["Jamaica", 5], ["Oman", 6],
        ["Tanzania", 1], ["Yemen", 2], ["Pakistan", 116], ["South Africa", 86], ["Albania", 2],
        ["Macau", 4], ["Nicaragua", 1], ["El Salvador", 4], ["Kosovo", 2], ["India", 2895],
        ["Azerbaijan", 2], ["United States", 11806], ["Kenya", 10], ["Tajikistan", 1], ["Turkey", 200],
        ["Bangladesh", 15], ["Mongolia", 4], ["France", 1147], ["Slovakia", 16], ["Peru", 24],
        ["Laos", 1], ["Norway", 373], ["Malawi", 1], ["Sri Lanka", 13], ["Singapore", 218],
        ["China", 1623], ["Armenia", 10], ["Sierra Leone", 1], ["Ukraine", 31], ["Bahrain", 2],
        ["Finland", 163], ["Libya", 2], ["Indonesia", 200], ["Costa Rica", 6], ["Mauritius", 1],
        ["Sweden", 332], ["Vietnam", 261], ["Czech Republic", 210], ["Cªte dÍIvoire", 1], ["Russia", 407],
        ["United Arab Emirates", 16], ["Romania", 197], ["Angola", 3], ["Portugal", 244], ["Bosnia and Herzegovina", 4],
        ["Malaysia", 174], ["Austria", 315], ["Uganda", 5], ["Hungary", 103], ["Brazil", 1048],
        ["United Kingdom", 2026], ["Kuwait", 2], ["Panama", 2], ["Luxembourg", 7], ["Ireland", 84],
        ["Syria", 1], ["Nigeria", 19], ["Ecuador", 15], ["Brunei", 3], ["Australia", 464],
        ["Iran", 250], ["Algeria", 18], ["Chile", 306], ["Belgium", 246], ["Thailand", 135],
        ["Haiti", 1], ["Bulgaria", 61], ["Georgia", 4], ["Denmark", 331], ["Philippines", 58],
        ["Moldova", 100], ["Morocco", 6], ["Croatia", 79], ["Switzerland", 589], ["New Zealand", 175],
        ["Iraq", 14], ["Estonia", 14], ["Uruguay", 89], ["Lebanon", 16], ["Puerto Rico", 7],
        ["Uzbekistan", 2], ["Tunisia", 176], ["Colombia", 116], ["Taiwan", 459], ["Cyprus", 7],
        ["Barbados", 1], ["Qatar", 4], ["Dominican Republic", 3], ["Italy", 1077], ["Sudan", 1],
        ["Nepal", 1], ["Malta", 21], ["Suriname", 5], ["Anguilla", 1], ["Venezuela", 12],
        ["Israel", 229], ["Iceland", 10], ["Zambia", 2], ["Senegal", 1], ["Zimbabwe", 1],
        ["Jordan", 5], ["Kazakhstan", 3], ["Poland", 471], ["Macedonia", 2], ["South Korea", 602],
        ["Latvia", 7], ["Japan", 1323], ["Belarus", 9], ["Cape Verde", 1], ["Trinidad and Tobago", 3],
        ["Mexico", 454], ["Egypt", 55], ["R_union", 6], ["Cuba", 5], ["Serbia", 55],
        ["Hong Kong", 125], ["Greece", 134], ["Paraguay", 1], ["Namibia", 1],
        ]);

      };

      // Define charts drawing
      function drawChart() {
        addData();
  
        var chart1 = new google.visualization.ComboChart(document.getElementById('apbs1'));
        chart1.draw(data1, options1);

        //NPW var chart2 = new google.visualization.GeoChart(document.getElementById('apbs2'));
        //NPW chart2.draw(data2, options2);
      }

      // Draw charts
      google.setOnLoadCallback(drawChart);

    </script>
  </head>

  <body>
    <h3 align="center"><font color="#0082A0">APBS statistics</font></h3>
        <strong>Bar chart</strong>: the total number of registerd users of APBS.<br>
<!-- NPW
        <strong>Map</strong>: geographical distribution of <a href="http://www.poissonboltzmann.org">APBS website</a>
        visits, as tracked by google analytics over the calendar year. <br>For 2014 only half a year is available due
        to the loss of google analytics data.<br><br>
NPW -->
        Use <b>Convert</b> buttons to view an image in a frame below and 
        <b>Save</b> buttons to copy an image to your Desktop.<br>

    <!-- chart and map -->
    <div id="apbs1" style="width: 400px; height: 360px; float: left"></div>
    <div id="apbs2" style="width: 400px; height: 360px; float: left"></div>
    <br style="clear: left;" />

    <!-- chart buttons -->
    <button style="position:relative; left:60 " onclick="saveAsImg(document.getElementById('apbs1'));">
        Save chart as PNG image
    </button>
    <button style="position:relative; left:60" onclick="toImg(document.getElementById('apbs1'), document.getElementById('img_div'));">
        Convert chart to image
    </button>

<!-- NPW
    <!-- map buttons -->
    <button style="position:relative; left:200 " onclick="saveAsImg(document.getElementById('apbs2'));">
        Save map as PNG image
    </button>
    <button style="position:relative; left:200" onclick="toImg(document.getElementById('apbs2'), document.getElementById('img_div'));">
        Convert map to image
    </button>
NPW -->
    <br />

    <!-- "image placement" position  on the page-->
    <div id="img_div" style="width: 400px; position: relative; top:10;  z-index: 10; border: 1px solid #0082A0; color: #0082A0">
      Image will be placed here
    </div>

  </body>
</html>
