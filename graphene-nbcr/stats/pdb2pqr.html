<html>
  <head>
    <script type="text/javascript" src="http://canvg.googlecode.com/svn/trunk/rgbcolor.js"></script> 
    <script type="text/javascript" src="http://canvg.googlecode.com/svn/trunk/canvg.js"></script>
    <script type="text/javascript" src="https://www.google.com/jsapi"></script>
    <script type="text/javascript" src="base.js"> </script>

    <script type="text/javascript">
      // Define variables for the charts 

        // PDB2PQR registered users by year
        var data1 = new google.visualization.DataTable();
        data1.addColumn({ type: 'string', label: 'Labels' });
        data1.addColumn({ type: 'number', label: 'Count' });
        data1.addColumn({ type: 'number', label: '' });
        data1.addColumn({ type: 'string', role: 'annotation' });

        var options1 = {
            width: 400, 
            height: 360, 
            title: 'Registered users of PDB2PQR',
            colors: ['#3b96ce'],
            hAxis: {title: 'Year', textStyle: {color: 'black', fontSize: 11}},
            vAxis: {ticks: [7500, 8000, 8500, 9000, 9500], title: 'Count', textStyle: {color: 'black', fontSize: 11}},
            series: [{ type: 'bars',  visibleInLegend:false },
                    { type: 'line', color:'black', lineWidth: 0, visibleInLegend:false, pointSize: 0}]
        };

        // Website access world geographical distribution 
        var data2 = new google.visualization.DataTable();
        data2.addColumn('string', 'Country');
        data2.addColumn('number', 'Web service access ');

        var options2 = {
            resolution: "country",
            width: 400, 
            backgroundColor: "#FFFFFF",
            datalessRegionColor: "#EEE5E5",
            colorAxis: { colors : ['#b3e2f9','#0860b3' ], },
        };

      // Add data from stats
      function addData() {
        data1.addRows([
            ["2013", 8017, 8017, '8017'],
            ["2014", 9232, 9232, '9232'],
            ["2015", 9704, 9704, '9704'],
        ]);

        data2.addRows([
        ["Canada", 1355], ["Saudi Arabia", 23], ["Lithuania", 73], ["Palestine", 2],
        ["Argentina", 336], ["Ghana", 2], ["Slovenia", 108], ["Spain", 1108],
        ["Netherlands", 237], ["Yemen", 1], ["Pakistan", 18], ["South Africa", 101],
        ["Macau", 17], ["Kosovo", 1], ["India", 2690], ["Azerbaijan", 1],
        ["United States", 11687], ["Kenya", 15], ["Turkey", 372], ["Bangladesh", 45],
        ["France", 1469], ["Slovakia", 5], ["Peru", 28], ["Norway", 274],
        ["Sri Lanka", 19], ["Singapore", 465], ["China", 2304], ["Armenia", 1],
        ["Ukraine", 42], ["Bahrain", 1], ["Finland", 130], ["Indonesia", 175],
        ["Costa Rica", 1], ["Sweden", 354], ["Vietnam", 38], ["Czech Republic", 262],
        ["Mali", 13], ["Russia", 254], ["United Arab Emirates", 2], ["Romania", 8],
        ["Portugal", 441], ["Malaysia", 167], ["Austria", 245], ["Hungary", 105],
        ["Brazil", 1929], ["United Kingdom", 2196], ["Panama", 4], ["Luxembourg", 1],
        ["Ireland", 50], ["Nigeria", 3], ["Ecuador", 6], ["Australia", 616],
        ["Iran", 329], ["Algeria", 6], ["Chile", 633], ["Belgium", 355],
        ["Thailand", 290], ["Bulgaria", 17], ["Georgia", 7], ["Denmark", 325],
        ["Poland", 647], ["Morocco", 9], ["Croatia", 75], ["Switzerland", 747],
        ["New Zealand", 154], ["Iraq", 1], ["Uruguay", 329], ["Lebanon", 1],
        ["Puerto Rico", 2], ["Egypt", 51], ["Colombia", 177], ["Taiwan", 482],
        ["Cyprus", 2], ["Italy", 867], ["Venezuela", 3], ["Israel", 327],
        ["Iceland", 5], ["Germany", 2818], ["Kazakhstan", 312], ["Philippines", 92],
        ["South Korea", 719], ["Latvia", 2], ["Japan", 2088], ["Bosnia & Herzegovina", 2],
        ["Mexico", 969], ["Tunisia", 14], ["R_union", 7], ["Cuba", 36],
        ["Serbia", 29], ["Hong Kong", 281], ["Greece", 88], ["Vatican City", 2],
        ]);

      };

      // Define charts drawing
      function drawChart() {
        addData();
  
        var chart1 = new google.visualization.ComboChart(document.getElementById('apbs1'));
        chart1.draw(data1, options1);
        
        var chart2 = new google.visualization.GeoChart(document.getElementById('apbs2'));
        chart2.draw(data2, options2);
      }

      // Draw charts
      google.setOnLoadCallback(drawChart);

    </script>
  </head>

  <body>
    <h3 align="center"><font color="#0082A0">PDB2PQR statistics</font></h3>
        <strong>Bar chart</strong>: the total number of registerd users of PDB2PQR.<br>
        <strong>Map</strong>: geographical distribution of <a href="http://www.poissonboltzmann.org">PDB2PQR website</a>
        visits, as tracked by google analytics over the calendar year. <br>For 2014 only half a year is available due
        to the loss of google analytics data.<br><br>
        Use <b>Convert</b> buttons to view an image in a frame below and 
        <b>Save</b> buttons to copy an image to your Desktop.<br>

    <!-- chart and map -->
    <div id="apbs1" style="width: 400px; height: 360px; float: left"></div>
    <div id="apbs2" style="width: 400px; height: 360px; float: left"></div>
    <br style="clear: left;" />

    <!-- chart buttons -->
    <button style="position:relative; left:60 " onclick="saveAsImg(document.getElementById('apbs1'));">
        Save chart as PNG image
    </button>
    <button style="position:relative; left:60" onclick="toImg(document.getElementById('apbs1'), document.getElementById('img_div'));">
        Convert chart to image
    </button>

    <!-- map buttons -->
    <button style="position:relative; left:200 " onclick="saveAsImg(document.getElementById('apbs2'));">
        Save map as PNG image
    </button>
    <button style="position:relative; left:200" onclick="toImg(document.getElementById('apbs2'), document.getElementById('img_div'));">
        Convert map to image
    </button>
    <br />

    <!-- "image placement" position  on the page-->
    <div id="img_div" style="width: 400px; position: relative; top:10;  z-index: 10; border: 1px solid #0082A0; color: #0082A0">
      Image will be placed here
    </div>

  </body>
</html>
