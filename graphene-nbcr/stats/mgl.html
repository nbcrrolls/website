<html>
  <head>
    <script type="text/javascript" src="http://canvg.googlecode.com/svn/trunk/rgbcolor.js"></script> 
    <script type="text/javascript" src="http://canvg.googlecode.com/svn/trunk/canvg.js"></script>
    <script type="text/javascript" src="https://www.google.com/jsapi"></script>
    <script type="text/javascript" src="base.js"> </script>

    <script type="text/javascript">
      // Define variables for the charts 

      // MGLTools registered users
      var data1 = new google.visualization.DataTable();
      data1.addColumn({ type: 'string', label: 'Labels' });
      data1.addColumn({ type: 'number', label: 'Count' });
      data1.addColumn({ type: 'number', label: '' });
      data1.addColumn({ type: 'string', role: 'annotation' });

      var options1 = {
          width: 400, 
          height: 360, 
          title: 'MGLTools registered users',
          colors: ['#9532bc'],
          hAxis: {title: 'Year', textStyle: {color: 'black', fontSize: 11}},
          vAxis: {title: 'Count', textStyle: {color: 'black', fontSize: 11}},
          series: [{ type: 'bars',  visibleInLegend:false },
                  { type: 'line', color:'black', lineWidth: 0, visibleInLegend:false, pointSize: 0}]
      };

      // Web services access from uniq hostip: World geographical distribution 
      var data2 = new google.visualization.DataTable();
      data2.addColumn('string', 'Country');
      data2.addColumn('number', 'Count of service access');

      var options2 = {
          resolution: "country",
          width: 400, 
          height: 360, 
          backgroundColor: "#FFFFFF",
          datalessRegionColor: "#E5E5E5",
          colorAxis: { colors : ['#b3e2f9','#0860b3' ], },
      };

      // Add data from stats
      function addData() {

        // registered users 
        data1.addRows([
            ["2011", 10910, 10910, '10910'],
            ["2012", 14150, 14150, '14150'],
            ["2013", 18441, 18441, '18441'],
            ["2014", 20086, 20086, '20086'],
            ["2015", 21667, 21667, '21667'],
        ]);

        // access from uniq hostip
        data2.addRows([
            ["United States",16721], ["India",12630], ["China",7182], ["United Kingdom",2524], ["Japan",2512],
            ["Germany",2440], ["Brazil",2362], ["Italy",1815], ["Mexico",1701], ["Canada",1517],
            ["France",1511], ["Iran",1456], ["Spain",1218], ["South Korea",1170], ["Poland",1095],
            ["Australia",967], ["Turkey",927], ["Taiwan",889], ["Malaysia",863], ["Pakistan",820],
            ["Russia",707], ["Portugal",647], ["(not set)",640], ["Thailand",634], ["Indonesia",627],
            ["Chile",616], ["Colombia",546], ["Singapore",529], ["Switzerland",509], ["Sweden",480],
            ["Netherlands",462], ["Argentina",450], ["Belgium",394], ["Egypt",355], ["Hong Kong",316],
            ["Czech Republic",314], ["Ukraine",288], ["Austria",282], ["Algeria",271], ["South Africa",255],
            ["Israel",247], ["Vietnam",247], ["Greece",218], ["Serbia",214], ["Bangladesh",207],
            ["Hungary",206], ["Ireland",202], ["Denmark",194], ["Morocco",189], ["Finland",186],
            ["Philippines",163], ["Saudi Arabia",151], ["Peru",149], ["Romania",135], ["Slovenia",120],
            ["Norway",108], ["Puerto Rico",91], ["United Arab Emirates",90], ["Sri Lanka",86], ["Venezuela",81],
            ["Kenya",73], ["Croatia",71], ["Armenia",69], ["Nigeria",67], ["New Zealand",66],
            ["Belarus",65], ["Jordan",64], ["Tunisia",64], ["Bulgaria",63], ["Iraq",63],
            ["Sudan",62], ["Guatemala",53], ["Estonia",42], ["Macau",40], ["Lithuania",38],
            ["Mongolia",38], ["Slovakia",38], ["Cuba",37], ["Cyprus",37], ["Latvia",32],
            ["Ecuador",30], ["Lebanon",29], ["Uzbekistan",28], ["Azerbaijan",27], ["Ghana",25],
            ["Senegal",23], ["Uruguay",23], ["Luxembourg",21], ["Cameroon",20], ["Costa Rica",17],
            ["Palestine",17], ["Libya",15], ["Qatar",15], ["Syria",15], ["Georgia",13],
            ["Moldova",13], ["Kazakhstan",11], ["Nepal",11], ["Dominican Republic",10], ["Bolivia",9],
            ["Ethiopia",9], ["Iceland",9], ["Malta",8], ["Macedonia (FYROM)",7], ["Albania",6],
            ["Saint Lucia",6], ["Oman",6], ["Côte d’Ivoire",5], ["Paraguay",5], ["St. Vincent & Grenadines",5],
            ["Kosovo",5], ["Barbados",4], ["Bahrain",4], ["Kyrgyzstan",4], ["North Korea",4],
            ["Mauritius",4], ["Panama",4], ["Bosnia and Herzegovina",3], ["French Guiana",3], ["Kuwait",3],
            ["Laos",3], ["Rwanda",3], ["Trinidad and Tobago",3], ["Brunei",2], ["Fiji",2],
            ["Honduras",2], ["Jamaica",2], ["Martinique",2], ["Maldives",2], ["Nicaragua",2],
            ["Réunion",2], ["Tanzania",2], ["Uganda",2], ["Afghanistan",1], ["Angola",1],
            ["Burkina Faso",1], ["Bermuda",1], ["Botswana",1], ["Faroe Islands",1], ["Gibraltar",1],
            ["Guam",1], ["Cambodia",1], ["Montenegro",1], ["Madagascar",1], ["Mali",1],
            ["Montserrat",1], ["Namibia",1], ["El Salvador",1], ["Swaziland",1], ["Turks and Caicos Islands",1],
            ["Yemen",1], ["Zimbabwe",1],
        ]);
      } 

      // Define charts drawing
      function drawChart() {
        addData();

        // registered users
        var chart1 = new google.visualization.ComboChart(document.getElementById('mgl1'));
        chart1.draw(data1, options1);
        
        // Web services access from uniq hostip: World geographical distribution 
        //NPW var chart2 = new google.visualization.GeoChart(document.getElementById('mgl2'));
        //NPW chart2.draw(data2, options2);
      }

      // Draw charts
      google.setOnLoadCallback(drawChart);

    </script>

  </head>
  <body>
    <h3 align="center"><font color="#0082A0">MGLTools statistics</font></h3>
        <strong>Bar chart</strong>: the total number of registerd users of MGLtools.<br>
        Note: count of users who chose to register after starting the tool 10 times.<br><br>
<!-- NPW 
        <strong>Map</strong>: geographical distribution of <a href="http://mgltools.scripps.edu">MGLTools website</a> visits,
        as tracked through google analytics over the calendar year.<br>
NPW -->
    <!-- bar chart and map -->
    <div id="mgl1"     style="width: 400px; height: 360px; float: left"></div>
    <div id="mgl2" style="width: 400px; height: 360px; float: left"></div>
    <br style="clear: left;" />

    <!-- bar chart buttons -->
    <button style="position:relative; left:40 " onclick="saveAsImg(document.getElementById('mgl1'));">
        Save bar chart as image
    </button>
    <button style="position:relative; left:40" onclick="toImg(document.getElementById('mgl1'), document.getElementById('img_div'));">
        Convert bar chart to image
    </button>
    
    <!-- map buttons -->
<!-- NPW
    <button style="position:relative; left:100 " onclick="saveAsImg(document.getElementById('mgl2'));">
        Save map as image
    </button>
    <button style="position:relative; left:100" onclick="toImg(document.getElementById('mgl2'), document.getElementById('img_div'));">
        Convert map to image
    </button>
NPW -->
    <!-- "image placement" position  on the page-->
    <div id="img_div" style="width: 400px; position: relative; top:10;  z-index: 10; border: 1px solid #0082A0; color: #0082A0">
      Image will be placed here
    </div>

</body>
</html>
